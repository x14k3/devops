# mstsc-远程连接

创建与远程桌面会话主机服务器或其他远程计算机的连接，以及编辑现有的远程桌面连接 (.rdp) 配置文件。

## 语法

```
mstsc.exe [<connectionfile>] [/v:<server>[:<port>]] [/g:<gateway>] [/admin] [/f <fullscreen>] [/w:<width> /h:<height>] [/public] [/multimon] [/l] [/restrictedadmin] [/remoteguard] [/prompt] [/shadow:<sessionid>] [/control] [/noconsentprompt]
mstsc.exe /edit <connectionfile> 
```

### 参数

|参数|描述|
| ------------------| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|​`<connectionfile>`​|为连接指定 .rdp 文件的名称。|
|/v:`<server>[:<port>]`​|指定远程计算机和（可选）要连接到的端口号。|
|/g:`<gateway>`​|指定用于连接的 RD 网关服务器。 仅当使用 /v 指定终结点电脑时才会读取此参数。|
|/admin|将你连接到用于管理服务器的会话。|
|/f|以全屏模式启动远程桌面连接。|
|/w:`<width>`​|指定远程桌面窗口的宽度。|
|/h:`<height>`​|指定远程桌面窗口的高度。|
|/public|在公共模式下运行远程桌面。 在公共模式下，不会缓存密码和位图。|
|/multimon|将远程桌面服务会话监视器布局配置为与当前客户端配置相同。|
|/l|枚举连接到本地电脑的监视器，以及与每个监视器关联的 ID。 监视器 ID 可用于填充选定的监视器 RDP 文件设置。|
|/edit`<connectionfile>`​|打开指定的 .rdp 文件进行编辑。|
|/restrictedAdmin|此模式不会将你的凭据发送到远程电脑，这可以在你连接到已遭入侵的设备时提供保护。 从远程电脑建立的连接可能无法通过其他电脑的身份验证，这会影响应用程序的功能和兼容性。 /admin 参数是隐含性的。|
|/remoteGuard|此模式可防止将凭据发送到远程电脑，这有助于在连接到已遭入侵的设备时保护凭据。 与“受限管理员”模式不同，远程防护还会通过将所有请求重定向回到设备来支持从远程电脑建立的连接。|
|/prompt|连接到远程电脑时提示你输入凭据。|
|/shadow:`<sessionID>`​|指定要掩蔽的会话的 ID。|
|/control|允许在掩蔽时控制会话。|
|/noConsentPrompt|允许在未经用户同意的情况下进行掩蔽。|
|/?|在命令提示符下显示帮助。|

#### 注解

* 将在用户的 Documents 文件夹中以隐藏文件的形式为每个用户存储 Default.rdp。
* 用户创建的 .rdp 文件默认保存在用户的 Documents 文件夹中，但也可以保存在任何位置。
* 若要跨越多个监视器，监视器必须使用相同的分辨率并且必须水平对齐（即并排）。 目前不支持跨越在客户端系统上垂直放置的多个监视器。

### 示例

若要以全屏模式连接到会话，请键入：

```
mstsc /v:computer1 /f
```

若要分配宽度/高度，请键入：

```
mstsc /v:computer1 /w:1920 /h:1080
```

若要打开名为 filename.rdp 的文件进行编辑，请键入：

```
mstsc /edit filename.rdp
```

‍

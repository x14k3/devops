# tracert

　　此诊断工具通过向目标发送 Internet 控制消息协议 (ICMP) 回显请求或 ICMPv6 消息，并以递增的生存时间 (TTL)  字段值来确定到达目标的路径。 路径上的每个路由器都需要将 IP 数据包中的 TTL 至少减 1，然后再转发 IP 数据包。 实际上，TTL  是最大链路计数器。 当数据包上的 TTL 达到 0 时，路由器将向源计算机返回 ICMP 超时消息。

　　此命令确定路径的方式如下：发送 TTL 为 1 的第一条回显请求消息，并在随后的每次传输中将 TTL 递增 1，直到目标作出响应或达到最大跃点数。 默认情况下，最大跃点数为 30，可使用 /h 参数指定。

　　通过检查中间路由器返回的 ICMP 超时消息以及目标返回的回显回复消息来确定路径。 但对于 TTL 值已过期的数据包，某些路由器不会返回超时消息，并且对 **tracert** 命令不可见。 在这种情况下，将为该跃点显示一行星号 (`*`​)。 显示的路径是源主机和目标之间路径中的路由器的近侧路由器接口列表。 近侧接口是路径中离发送主机最近的路由器接口。

> 仅当 Internet 协议 (TCP/IP) 协议作为组件安装在网络连接的网络适配器的属性中时，此命令才可用。
>
> 要跟踪路径并提供路径中每个路由器和链路的网络延迟和数据包丢失情况，请使用 [pathping](https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/pathping) 命令。

　　‍

## 语法

```
tracert [/d] [/h <maximumhops>] [/j <hostlist>] [/w <timeout>] [/R] [/S <srcaddr>] [/4][/6] <targetname>
```

### 参数

|参数|说明|
| ------| -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|/d|停止尝试将中间路由器的 IP 地址解析为其名称。 这可以加快结果的返回速度。|
|/h`<maximumhops>`​|指定搜索目标的路径中的最大跃点数。 默认值为 30 个跃点。|
|/j`<hostlist>`​|指定回显请求消息使用 IP 标头中的“松散源路由”选项，它带有`<hostlist>`​中指定的一组中间目标。 使用松散源路由时，连续的中间目标可由一个或多个路由器分隔。 列表中的地址或名称数目不超过 9。`<hostlist>`​是一系列由空格分隔的 IP 地址（采用点分十进制格式）。 仅在跟踪 IPv4 地址时使用此参数。|
|/w`<timeout>`​|指定等待接收与给定回显请求消息对应的 ICMP 超时或回显回复消息的时间（以毫秒为单位）。 如果在超时值内未收到，则显示星号 (`*`​)。 默认超时值为 4000（4 秒）。|
|/R|指定使用 IPv6 路由扩展标头向本地主机发送回显请求消息，将目标用作中间目标并测试反向路由。|
|/S`<srcaddr>`​|指定要在回显请求消息中使用的源地址。 仅在跟踪 IPv6 地址时使用此参数。|
|/4|指定 tracert.exe 只能使用 IPv4 进行此跟踪。|
|/6|指定 tracert.exe 只能使用 IPv6 进行此跟踪。|
|​`<targetname>`​|指定目标，该目标由 IP 地址或主机名标识。|
|/?|在命令提示符下显示帮助。|

## 示例

　　要跟踪名为 `www.microsoft.com`​ 的主机的路径，请键入：

```
tracert www.microsoft.com
```

　　下面是示例输出：

　　**输出**

```
Tracing route to e13678.dscb.akamaiedge.net [23.216.93.114]
over a maximum of 30 hops:

 1     1 ms     1 ms    <1 ms  <devicename>.mshome.net [172.26.96.1]
 2    11 ms    13 ms     6 ms  192.168.191.20
 3    20 ms    11 ms    18 ms  192.168.1.1
 4    44 ms    41 ms    35 ms  10.228.0.1
 5    32 ms    31 ms    46 ms  10.41.0.49
 6    36 ms    39 ms    30 ms  10.41.0.221
 7    35 ms    36 ms    39 ms  10.41.0.225
 8    54 ms    45 ms    50 ms  204.111.0.147
 9    50 ms    52 ms    47 ms  ae-39.a02.atlnga05.us.bb.gin.ntt.net [128.241.219.117]
10    53 ms    51 ms    61 ms  ae-5.r24.atlnga05.us.bb.gin.ntt.net [129.250.4.192]
11    64 ms    45 ms    44 ms  ae-0.a03.atlnga05.us.bb.gin.ntt.net [129.250.2.20]
12    49 ms    67 ms    46 ms  ae-0.akamai-onnet.atlnga05.us.bb.gin.ntt.net [128.241.1.122]
13    67 ms   287 ms     *     ae20.r03.border101.atl02.fab.netarch.akamai.com [23.203.144.21]
14     *        *        *     Request timed out.
15     *        *        *     Request timed out.
16     *        *        *     Request timed out.
17   204 ms    58 ms    51 ms  a23-216-93-114.deploy.static.akamaitechnologies.com [23.216.93.114]

Trace complete.
```

　　起始列显示从 1 开始的跃点编号，并沿从设备到目标的路由随每个跃点递增。 每个跃点表示一个数据包到达最终目标时通过的中间设备，例如路由器。

　　三个中心列显示数据包在特定跃点从设备到路由器再返回到设备的往返时间（毫秒）。 它被称为“ping 时间”或“ping 延迟”，并用于度量数据前往路由器并返回的延迟（以毫秒为单位）。 网络延迟可能会受到网络拥塞、网络链接质量以及跃点之间距离等因素的影响。

　　结束列显示在网络路径中该特定跃点处的路由器或中间设备的 IP 地址或主机名。 在大多数情况下，你将看到 IP 地址，但如果反向 DNS 查找成功，它将显示主机名，这有助于按名称标识路由器。

　　要跟踪名为 `www.microsoft.com`​ 的主机的路径，并阻止将每个 IP 地址解析为其名称，请键入以下内容：

```
tracert /d www.microsoft.com
```

　　要跟踪命名 `www.microsoft.com`​ 的主机的路径并使用松散源路由 *10.12.0.1/10.29.3.1/10.1.44.1*，请键入：

```
tracert /j 10.12.0.1 10.29.3.1 10.1.44.1 www.microsoft.com
```

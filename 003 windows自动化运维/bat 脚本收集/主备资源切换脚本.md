# 主备资源切换脚本

### windows7_x86

```bat
@echo off
ipconfig | findstr "172.168.0.129" > /nul
set vip_stat=%errorlevel%
tasklist | findstr /i "calc.exe" > /nul
set prog_stat=%errorlevel%
if %vip_stat%==0 (
	if %prog_stat%==0 (
		echo vip已存在，[calc.exe]正在正常运行
		timeout 5 /NOBREAK > /nul
	) else (
		echo vip已存在，正在启动[calc.exe]
		start C:\Windows\System32\calc.exe
		timeout 5 /NOBREAK > /nul
	)
) else (
	echo 未检测到VIP,正在添加VIP 172.168.0.129
	netsh interface ipv4 set address "本地连接" static 172.168.0.129 255.255.255.0 172.168.0.1 1
	timeout 2 /NOBREAK > /nul
	if %prog_stat%==0 (
		echo vip添加完成，正在重启[calc.exe]
		taskkill /F /IM "calc.exe" > /nul
		timeout 3 /NOBREAK > /nul
		start  C:\Windows\System32\calc.exe
		timeout 5 /NOBREAK > /nul
		netsh interface ipv4 add address "本地连接" 172.168.0.128 255.255.255.0
	) else (
		echo vip添加完成，正在启动[calc.exe]
		timeout 2 /NOBREAK > /nul
		start C:\Windows\System32\calc.exe
		timeout 5 /NOBREAK > /nul
		netsh interface ipv4 add address "本地连接" 172.168.0.128 255.255.255.0
	)
)
```

‍

# 11. Linux bootgrubgrub.conf（GRUB配置文件）内容详解

本节，我们就来看看 GRUB 的配置文件 /boot/gmb/grub.conf 中到底写了什么。命令如下：

```bash
[rootdlocalhost ~]# vi /boot/grub/grub.conf
default=0
timeout=5
splashimage=(hd0,0)/grub/splash.xpm.gz
hiddenmenu
#以上为GRUB的整体设置
title CentOS (2.6.32-279.el6.i686)
root (hdO,0)
kernel /vmlinuz-2.6.32-279.el6.i686 ro root=OOID=b9a7ala8-767f-4a87-8a2b-a535edb362c9 rd_NO_LUKS KEYBOARDTYPE=pc KEYTABLE=us rd_NO_MD crashkernel= auto LANG=zh_CN.UTF-8 rd_NO_LVM rd_NO_DM rhgb quiet
initrd /initramfs-2.6.32-279.el6.i686.img
```

这个文件的内容可以分成两部分：前 4 行为 GRUB 的整体设置；title 以下 4 行为要启动的 CentOS 系统的具体配置。这里只安装了一个系统，如果多系统并存，那么每个系统都会有类似的 title 行存在（不一定都是 4 行）。

我们先看整体设置：

* default=0：默认启动第一个系统。也就是说，如果在等待时间结束后，用户没有选择进入哪个系统，那么系统会默认进入第一个系统。如果有多系统并存，那么每个系统都会有自己的 title 字段，如果想要默认进入第二个系统，这里就可以设为 default=1。

* timeout=5：等待时间，默认是 5 秒。也就是在进入系统时，如果 5 秒内用户没有按下任意键，那么系统会进入 default  字段定义的系统。当然，也可以手工修改这个等待时间，如果timeout=0，则不会等待直接进入系统；如果  timeout=-1，则会一直等待用户输入，而不会自动进入系统。
* splashimage=(hd0,0)/gnjb/splash.xpm.gz：用来指定 GRUB 启动时的背景图像的保存位置。记得 CentOS  6.x 启动时后台的蓝色图像吧，就是这个文件的作用。不过这个文件具体在哪里呢？我们已经说过，hd(0,0)  代表第一块硬盘的第一个分区，而笔者的系统在安装时 /boot 分区就是第一个分区，所以这个背景图像的实际位置就是  /boot/gmb/splash.xpm.gz。
* hiddenmenu：隐藏菜单。启动时默认只能看到读秒，而不能看到菜单。如果想要看到菜单，则需要按任意键。如果注释了这句话，那么启动时就能直接看到菜单了。

再来介绍 CentOS 系统的具体配置： 

1. title CentOS(2.6.32-279.d6.i686)：title 就是标题的意思，也就是说，在 title 后面写入的是什么，系统启动时在 GRUB 的启动菜单中看到的就是什么。

2. root（hd0,0）：是指启动程序的保存分区。这里要注意，这个 root 并不是管理员。在我的系统中，/boot 分区是独立划分的，而且设备文件名为 /dev/sda1，所以在 GRUB 中就被描述为 hd(0,0)。

3. kernel /vmlinuz-2.6.32-279.el6.i686 ro  root=UUID=b9a7a1a8-767f-4a87-8a2b-a535edb362c9 rd_NO_LUKS  KEYBOARDTYPE=pc KEYTABLE=us rd_NO_MD crashkernel=auto LANG=zh_CN.UTF-8  rd_NO_LVM rd_NO_DM rhgb quiet。其中：

    * /vmlinuz-2.6.32-279.el6.i686：指定了内核文件的位置，这里的 / 是指 boot 分区。
    * ro：启动时以只读方式挂载根文件系统，这是为了不让启动过程影响磁盘内的文件系统。
    * root=UUID=b9a7a1 a8-767f-4a87-8a2b-a535edb362c9：指定根文件系统的所在位置。这里和以前的Linux版本不太一样了，不再通过分区的设备文件名或卷标号来指定，而是通过分区的 UUID 来指定的。

 那么，如何査询分区的 UUID 呢？方法有很多种，最简单的办法就查询 /ec/fstab 文件。命令如下：

```bash
[root@localhost ~]# cat /etc/fetab | grep"/ "
UUID=b9a7a1a8-767f-4a87-8a2b-a535edb362c9 / ext4 defaults 1 1
```

可以看到"/"分区的 UUID 和 kernel 行中的 UUID 是匹配的。注意一下 grep 后的"/"，在"/"后是有空格的。

以下禁用都只是在启动过程中禁用，是为了加速系统启动的：

1. rd_NO_LUKS：禁用 LUKS，LUKS 用于给磁盘加密。
2. rd_NO_MD：禁用软 RAID。
3. rd_NO_DM：禁用硬 RAID。
4. rd_NO_LVM：禁用 LVM。

除了以上这样，命令输出信息中还包含以下内容：

1. KEYBOARDTYPE=pc KEYTABLE=us：键盘类型。
2. crashkernel=auto：自动为crashkernel预留内存。
3. LANG=zh_CN.UTF-8：语言环境。
4. rhgb：(redhatgraphics boot)用图片来代替启动过程中的文字信息。启动完成之后可以使用dmesg命令来查看这些文字信息。
5. quiet：隐藏启动信息，只显示重要信息。
6. initrd/initramfs-2.6.32-279.el6.i686.img：指定了initramfs虚拟文件系统镜像文件的所在位置。

GRUB的配置文件的内容就是这样的，主要是 kernel 行较为复杂。不过，在这个 /boot/gmb/grub.conf  配置文件中，只启动了一个 Linux 系统。如果在 Linux 服务器中 既安装了 Linux 系统，又安装了 Windows 系统，那么  GRUB 的配置文件又是什么样子的呢？

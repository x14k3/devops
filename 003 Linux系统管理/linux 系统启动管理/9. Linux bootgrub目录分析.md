# 9. Linux bootgrub目录分析

本章第一节就已经讲过，BIOS 在进行完成系统检测之后，就会找到第一个可以启动的设备，并读取该设备的 MBR（主引导记录）以及加载 MBR 中的  boot loader（启动引导程序），这个启动引导程序可以具有菜单功能、直接加载核心文件以及控制权移交的功能等。

另外我们还知道，系统必须要借助启动引导程序，才能加载内核，那么问题来了，MBR 只是占据整个设备的第一个扇区中，其大小也就只有 446 字节而已，但启动引导程序功能这么强大，光程序代码即配置数据就肯定不止 446 字节，是怎么安装的吗？

是这样的，Linux 系统将启动引导程序的程序代码运行与配置数据加载分为以下 2 个阶段： 

1.  第一个阶段负责运行启动引导的主程序，该主程序必须要被安装在启动区，或者是 MBR，或者是引导扇区，但我们说过，MBR 的容量实在太小啦，因此，MBR 或引导扇区通常只安装启动引导程序的最小主程序，并不安装相关的配置数据；

2. 第二个阶段是为主程序加载配置文件，包括相关的环境参数文件（文件系统定义以及主要配置文件 menu.1st）；

其中，与 GRUB（启动引导程序）相关的配置文件，都放置在 /boot/grub 目录中。我们来看看这个目录下到底有哪些文件。

```bash
[root@localhost ~]# cd /boot/grub/
[root@localhost grub]# ll -h
总用量274K
-rw-r--r--. 1 root root 63 4月 10 21:49 device.map
#GRUB中硬盘的设备文件名与系统的设备文件名的对应文件
-rw-r--r--. 1 root root 14K 4月 10 21:49 e2fs_stage1_5 #ext2/ext3文件系统的Stage 1.5文件
-rw-r--r--. 1 root root 13K 4月 10 21:49 fat_stage1_5
#FAT文件系统的Stage 1文件
-rw-r--r--. 1 root root 12K 4月 10 21:49 ffs_stage1_5
#FFS文件系统的Stage 1.5文件
-rw-------.1 root root 737 4月 10 21:49 grub.conf
#GRUB的配置文件
-rw-r--r--. 1 root root 12K 4 月 10 21:49 iso9660_stage1_5
#iso9660文件系统的Stage 1.5文件
-rw-r--r--. 1 root root 13K 4月 10 21:49 jfs_stage1_5
#JFS文件系统的Stage 1.5文件
Irwxrwxrwx. 1 root root 11 4月 10 21:49 menu.lst ->./grub.conf
#GRUB的配置文件。和grub.conf是软链接，所以两个文件修改哪一个都可以
-rw-r--r--. 1 root root 12K 4 月 10 21:49 minix_stage1_5
#MINIX文件系统的Stage 1.5文件
-rw-r--r--. 1 root root 15K 4 月 10 21:49 reiserfs_stage1_5
#ReiserFS文件系统的Stage 1.5文件
-rw-r--r--. 1 root root 1.4K 11 月 15 2010 splash.xpm.gz
#系统启动时，GRUB程序的背景图像
-rw-r--r--. 1 root root 512 4月 10 21:49 stage1
#安装到引导扇区中的Stage 1的备份文件
-rw-r--r--. 1 raot root 124K 4月 10 21:49 stage2 #Stage2的备份文件
-rw-r--r--. 1 root root 12K 4月 10 21:49 ufs2_stage1_5
#UFS文件系统的Stage 1.
-rw-r--r--. 1 root root 12K 4 月 10 21:49 vstafs_stage1_5
#vstafs文件系统的Stage 1.5文件
-rw-r--r--. 1 root root 14K 4月 10 21:49 xfs_stage1_5
#XFS文件系统的Stage 1.5文件
```

可以看到，这个目录中主要就是 GRUB 的配置文件和各种文件系统的 Stage1.5 文件。不过 GRUB  的配置文件有两个：/boot/grub/grub.conf 和  /boot/grub/menu.lst，这两个配置文件是软链接，所以修改哪一个都可以。

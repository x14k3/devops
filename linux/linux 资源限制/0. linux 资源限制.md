Linux系统中实现资源限制主要依赖于三个核心组件：`ulimit`命令、`/etc/security/limits.conf`配置文件以及`pam_limits`可插拔认证模块（Pluggable Authentication Module, PAM）。它们各自扮演着不同的角色，共同构成了灵活且强大的资源限制体系。

### **`ulimit` 命令**：  

**作用**：`ulimit`是一个内建于各种shell（如Bash）中的命令。它允许用户或脚本**查看和修改当前shell会话及其子进程的资源限制**。

**特点**：通过`ulimit`设置的限制只在当前shell会话及其派生的子进程中有效。当shell会话结束时，这些限制也会随之消失，不会影响其他用户的会话或系统重启后的状态。非特权用户只能降低硬限制或调整软限制（不能超过硬限制）；特权用户（root）可以修改软限制和硬限制。

### **`/etc/security/limits.conf` 文件**：  

**作用**：这是一个配置文件，用于**为特定的用户、组或所有用户设置系统范围内的、持久化的资源限制默认值**。  

特点**：`/etc/security/limits.conf`文件本身并不能直接生效。它的作用是提供一个配置列表。这些配置需要由**pam_limits模块**来读取和应用。该文件支持通过通配符（Wildcard）或指定具体的用户名、组名来定义不同域（Domain）的资源限制。此外，现在通常推荐使用`/etc/security/limits.d/`目录下的多个文件来替代单一的`limits.conf`文件，以提高配置的模块化和可维护性。

### **`pam_limits` 模块**：  

**作用**：`pam_limits`是PAM框架提供的一个模块。它的核心功能是在用户通过支持PAM的认证服务（如登录到终端、通过SSH连接、使用`su`切换用户等）成功认证后，**读取`/etc/security/limits.conf`（或`/etc/security/limits.d/`中的文件）中定义的资源限制，并将其应用到用户的登录会话或新进程环境**。  

特点**：`pam_limits`模块需要在`/etc/pam.d/`目录下的各个服务配置文件中显式启用。例如，在`/etc/pam.d/login`、`/etc/pam.d/sshd`或`/etc/pam.d/su`等文件中，会看到类似`session required pam_limits.so`的配置项，这指示PAM框架在会话建立阶段调用`pam_limits`模块来设置资源限制。它是实现`limits.conf`中持久化配置生效的关键环节。

这三者之间的关系可以简单概括为：`limits.conf`（及limits.d）定义了规则，`pam_limits`在用户登录时读取并执行这些规则，将资源限制应用到用户的会话环境中。一旦进入会话，用户可以通过`ulimit`命令在当前会话的基础上进一步查看或调整（通常是降低）其资源限制，但这不会影响其他会话或持久化配置。

在接下来的章节中，我们将依次深入探讨这三个组件的细节、用法、配置方法、相互关系以及实际应用，帮助您全面掌握Linux系统的资源限制技术
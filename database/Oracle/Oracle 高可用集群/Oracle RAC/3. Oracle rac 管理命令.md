#oracle

### 1. é›†ç¾¤æ§åˆ¶å‘½ä»¤ (`crsctl`)

- **ç”¨é€”ï¼š**Â ç”¨äº**å¯åŠ¨ã€åœæ­¢ã€æ£€æŸ¥ã€é…ç½®å’Œè¯Šæ–­ Oracle Clusterware æœ¬èº«ï¼ˆå³ GI çš„æ ¸å¿ƒé›†ç¾¤æ¡†æ¶ï¼‰**ã€‚è¿™æ˜¯ç®¡ç†é›†ç¾¤åŸºç¡€è®¾æ–½æœ€åº•å±‚çš„å‘½ä»¤ã€‚
- **å¸¸ç”¨å‘½ä»¤ (é€šå¸¸éœ€è¦ root æˆ– grid ç”¨æˆ·æƒé™):**
```bash
crsctl start crs    # åœ¨æœ¬åœ°èŠ‚ç‚¹ å¯åŠ¨ GI é›†ç¾¤æ ˆï¼ˆåŒ…æ‹¬ OHASD åŠåç»­æ‰€æœ‰å®ˆæŠ¤è¿›ç¨‹ï¼‰ã€‚
crsctl stop crs     # åœ¨æœ¬åœ°èŠ‚ç‚¹ åœæ­¢Â GI é›†ç¾¤æ ˆï¼ˆ`-f`Â å¼ºåˆ¶åœæ­¢ï¼‰ã€‚
crsctl enable crs   # è®¾ç½® GI åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨æ—¶ è‡ªåŠ¨å¯åŠ¨
crsctl disable crs  # ç¦æ­¢ GI åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ã€‚
crsctl check crs    # æ£€æŸ¥æœ¬åœ°èŠ‚ç‚¹ GI æ ¸å¿ƒå®ˆæŠ¤è¿›ç¨‹ï¼ˆOHASD, CRSD, CSSD, EVMDï¼‰çš„çŠ¶æ€ã€‚
crsctl stat res [-t] [-init]  # æŸ¥çœ‹é›†ç¾¤ç®¡ç†çš„æ‰€æœ‰èµ„æºçš„çŠ¶æ€ï¼ˆ`-t`Â è¡¨æ ¼å½¢å¼æ›´æ¸…æ™°ï¼Œ`-init`Â æ˜¾ç¤º OHASD ç®¡ç†çš„åˆå§‹èµ„æºï¼‰ã€‚
crsctl status resource [-f]   # æŸ¥çœ‹ç‰¹å®šèµ„æºçš„è¯¦ç»†çŠ¶æ€ï¼ˆä¾‹å¦‚Â `crsctl status resource ora.diskgroup.dgname`ï¼‰ã€‚
crsctl start resourceÂ /Â crsctl stop resource # Â å¯åŠ¨/åœæ­¢ç‰¹å®šé›†ç¾¤èµ„æºÂ (è°¨æ…ä½¿ç”¨ï¼Œé€šå¸¸æ¨èç”¨Â `srvctl`Â ç®¡ç†æ•°æ®åº“ç›¸å…³èµ„æº)ã€‚
crsctl query css votedisk     # æŸ¥çœ‹è¡¨å†³ç£ç›˜ (Voting Disks)Â çš„ä½ç½®å’ŒçŠ¶æ€ã€‚
crsctl replace votedisk       # æ›¿æ¢æˆ–æ·»åŠ  è¡¨å†³ç£ç›˜ï¼ˆéœ€è¦æå…¶è°¨æ…æ“ä½œï¼‰ã€‚
crsctl query css misscount    # æŸ¥çœ‹èŠ‚ç‚¹å¿ƒè·³è¶…æ—¶ (Misscount) è®¾ç½®ã€‚
crsctl set css misscount      # è®¾ç½®èŠ‚ç‚¹å¿ƒè·³è¶…æ—¶æ—¶é—´ (ä»…åœ¨ä¸“å®¶æŒ‡å¯¼ä¸‹ä¿®æ”¹)ã€‚
crsctl check cluster [-all]   # æ£€æŸ¥æ•´ä¸ªé›†ç¾¤æˆ–æ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€ã€‚
crsctl add/delete node        # å‘é›†ç¾¤æ·»åŠ æˆ–åˆ é™¤èŠ‚ç‚¹ (é€šå¸¸åœ¨ OUI æ‰§è¡Œæ·»åŠ åˆ é™¤èŠ‚ç‚¹æ“ä½œåä½¿ç”¨)ã€‚
crsctl config has             # æŸ¥çœ‹ Oracle High Availability Services (OHAS) çš„é…ç½®ã€‚
```

### 2. æœåŠ¡æ§åˆ¶å‘½ä»¤ (`srvctl`)

- **ç”¨é€”ï¼š**Â è¿™æ˜¯**æœ€å¸¸ç”¨**çš„å‘½ä»¤é›†ï¼Œç”¨äºç®¡ç†è¿è¡Œåœ¨ GI ä¹‹ä¸Šçš„**å…·ä½“åº”ç”¨èµ„æº**ï¼Œå¦‚æ•°æ®åº“å®ä¾‹ã€æ•°æ®åº“æœåŠ¡ã€ç›‘å¬å™¨ã€ASM å®ä¾‹ã€SCAN ç›‘å¬å™¨ç­‰ã€‚å®ƒæä¾›äº†å¯¹èµ„æºç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶ï¼ˆå¯åŠ¨ã€åœæ­¢ã€çŠ¶æ€æ£€æŸ¥ã€é…ç½®ä¿®æ”¹ï¼‰ã€‚
- **å¸¸ç”¨å‘½ä»¤ (é€šå¸¸ä½¿ç”¨ grid æˆ– oracle ç”¨æˆ·):**

```bash
# æ•°æ®åº“ (Database):
srvctl status database -db racdb  # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„çŠ¶æ€ï¼ˆæ‰€æœ‰å®ä¾‹ï¼‰ã€‚
srvctl start  database -db racdb  # å¯åŠ¨æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰å®ä¾‹ã€‚
srvctl stop   database -db racdb  # åœæ­¢æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰å®ä¾‹ï¼ˆ-o immediate/abortÂ æŒ‡å®šå…³é—­æ¨¡å¼ï¼‰ã€‚
srvctl config database -db racdb  # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„é…ç½®ä¿¡æ¯ï¼ˆèŠ‚ç‚¹åˆ—è¡¨ã€å®ä¾‹åã€æœåŠ¡ç­‰ï¼‰ã€‚
srvctl add/remove database        # æ·»åŠ /ç§»é™¤æ•°æ®åº“åˆ° GI ç®¡ç†ï¼ˆé€šå¸¸ç”± DBCA è‡ªåŠ¨å®Œæˆï¼‰ã€‚


# å®ä¾‹ (Instance):
srvctl status instance -db racdb -i orcl1      # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ç‰¹å®šå®ä¾‹çš„çŠ¶æ€ã€‚    
srvctl start  instance -db racdb -i orcl1      # å¯åŠ¨æŒ‡å®šæ•°æ®åº“çš„ç‰¹å®šå®ä¾‹ã€‚
srvctl stop   instance -db racdb -i orcl1      # åœæ­¢æŒ‡å®šæ•°æ®åº“çš„ç‰¹å®šå®ä¾‹ã€‚
srvctl relocate instance -db racdb -i orcl1 -n # å°†å®ä¾‹ä»ä¸€ä¸ªèŠ‚ç‚¹è¿ç§»ï¼ˆåœæ­¢å†å¯åŠ¨ï¼‰åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚


# æœåŠ¡ (Service):
srvctl status service -db       # æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰æœåŠ¡çš„çŠ¶æ€ã€‚
srvctl start service -db -s     # å¯åŠ¨æ•°æ®åº“çš„ç‰¹å®šæœåŠ¡ã€‚
srvctl stop service -db -s      # åœæ­¢æ•°æ®åº“çš„ç‰¹å®šæœåŠ¡ã€‚
srvctl config service -db -s    # æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„é…ç½®ï¼ˆè¿è¡Œåœ¨å“ªäº›å®ä¾‹ä¸Šï¼ŒTAF ç­–ç•¥ç­‰ï¼‰ã€‚
srvctl add/remove service       # æ·»åŠ /ç§»é™¤æœåŠ¡ã€‚
srvctl modify service           # ä¿®æ”¹æœåŠ¡é…ç½®ï¼ˆå¦‚æ·»åŠ /ç§»é™¤é¦–é€‰/å¯ç”¨å®ä¾‹ï¼Œä¿®æ”¹ TAF ç­–ç•¥ï¼‰ã€‚
srvctl relocate service -db -s -i -t  # å°†æœåŠ¡ä»ä¸€ä¸ªå®ä¾‹è¿ç§»åˆ°å¦ä¸€ä¸ªå®ä¾‹ã€‚

# ç›‘å¬å™¨ (Listener):
srvctl status listener                                 # æŸ¥çœ‹ç›‘å¬å™¨çŠ¶æ€ï¼ˆèŠ‚ç‚¹ç›‘å¬å™¨å’Œ SCAN ç›‘å¬å™¨ï¼‰ã€‚
srvctl start listenerÂ /Â srvctl stop listener           # å¯åŠ¨/åœæ­¢èŠ‚ç‚¹ç›‘å¬å™¨ã€‚
srvctl start scan_listenerÂ /Â srvctl stop scan_listener # å¯åŠ¨/åœæ­¢ SCAN ç›‘å¬å™¨ã€‚
srvctl config listener                                 # æŸ¥çœ‹ç›‘å¬å™¨é…ç½®ã€‚

# ASM (Automatic Storage Management):
srvctl status asm                    # æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹ ASM å®ä¾‹çš„çŠ¶æ€ã€‚
srvctl start asmÂ /Â srvctl stop asm   # å¯åŠ¨/åœæ­¢æ‰€æœ‰èŠ‚ç‚¹çš„ ASM å®ä¾‹ï¼ˆé€šå¸¸ç”±é›†ç¾¤è‡ªåŠ¨ç®¡ç†ï¼‰ã€‚
srvctl config asm                    # æŸ¥çœ‹ ASM é…ç½®ï¼ˆASM å®ä¾‹åã€SPFILE ä½ç½®ç­‰ï¼‰ã€‚
srvctl status diskgroup -g           # æŸ¥çœ‹æŒ‡å®šç£ç›˜ç»„çš„çŠ¶æ€ã€‚
srvctl start diskgroup -gÂ /Â srvctl stop diskgroup -g  # æŒ‚è½½/å¸è½½æŒ‡å®šç£ç›˜ç»„ï¼ˆé€šå¸¸ç”± ASM è‡ªåŠ¨ç®¡ç†æˆ–åœ¨ç»´æŠ¤æ—¶ä½¿ç”¨ï¼‰ã€‚

# èŠ‚ç‚¹åº”ç”¨ (Node Apps - VIP, ONS, GSD):
srvctl status nodeapps                          # æŸ¥çœ‹æœ¬åœ°èŠ‚ç‚¹ä¸Šæ‰€æœ‰èŠ‚ç‚¹åº”ç”¨ï¼ˆVIP, ONS, GSDï¼‰çš„çŠ¶æ€ã€‚
srvctl start nodeappsÂ /Â srvctl stop nodeapps    # å¯åŠ¨/åœæ­¢æœ¬åœ°èŠ‚ç‚¹çš„æ‰€æœ‰èŠ‚ç‚¹åº”ç”¨ã€‚
srvctl status vip -n                            # æŸ¥çœ‹ç‰¹å®šèŠ‚ç‚¹ VIP çš„çŠ¶æ€ã€‚
srvctl start vip -nÂ /Â srvctl stop vip -n        # å¯åŠ¨/åœæ­¢ç‰¹å®šèŠ‚ç‚¹çš„ VIPã€‚
srvctl relocate vip -n -i                       # å°† VIP ä»æ•…éšœèŠ‚ç‚¹è¿ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆé€šå¸¸ç”±é›†ç¾¤è‡ªåŠ¨å®Œæˆï¼‰ã€‚
```


### 3. ASM ç®¡ç†å‘½ä»¤ (`asmcmd`,Â `srvctl`)

- **`asmcmd`Â ç”¨é€”ï¼š**Â ä¸“é—¨ç”¨äºç®¡ç†å’Œæ“ä½œÂ **ASM å®ä¾‹å’Œç£ç›˜ç»„**ï¼ˆæ–‡ä»¶æ“ä½œã€ç£ç›˜ç»„ç®¡ç†ã€å…ƒæ•°æ®æŸ¥çœ‹ç­‰ï¼‰ã€‚

- **å¸¸ç”¨å‘½ä»¤ (åœ¨ ASM å®ä¾‹ç¯å¢ƒä¸­è¿è¡Œï¼Œé€šå¸¸ grid ç”¨æˆ·):**

```bash
lsdgÂ /Â lsdsk      # åˆ—å‡ºæ‰€æœ‰ç£ç›˜ç»„ / åˆ—å‡ºæ‰€æœ‰ ASM ç£ç›˜ã€‚
lsct              # åˆ—å‡ºå½“å‰è¿æ¥çš„å®¢æˆ·ç«¯ï¼ˆæ•°æ®åº“å®ä¾‹ï¼‰ã€‚
du                # æ˜¾ç¤º ASM ç›®å½•æˆ–æ–‡ä»¶çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
cdÂ /Â pwdÂ /Â ls     # åœ¨ ASM ç›®å½•ç»“æ„ä¸­å¯¼èˆªå’Œåˆ—å‡ºæ–‡ä»¶ï¼ˆç±»ä¼¼äº Linux shellï¼‰ã€‚
mkdirÂ /Â rm        # åˆ›å»º/åˆ é™¤ ASM ç›®å½•ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ã€‚
cp                # åœ¨ ASM å’Œ OS æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶ï¼ˆå¸¸ç”¨äºå¤‡ä»½æ¢å¤ï¼‰ã€‚
md_backupÂ /Â md_restore            # å¤‡ä»½/æ¢å¤ ASM ç£ç›˜ç»„çš„å…ƒæ•°æ®ã€‚
volcreateÂ /Â voldeleteÂ /Â volinfo   # ç®¡ç† ASM åŠ¨æ€å· (ADVM)ã€‚
lsop                      # æ˜¾ç¤º ASM å®ä¾‹ä¸Šæ­£åœ¨è¿›è¡Œçš„æ“ä½œã€‚
```


### 4. è¯Šæ–­ä¸éªŒè¯å·¥å…·

- **`ocrcheck`ï¼š**Â æ£€æŸ¥Â **Oracle Cluster Registry (OCR)**Â çš„çŠ¶æ€ã€å†…å®¹å’Œä¸€è‡´æ€§ã€‚`ocrcheck -local`Â (æœ¬åœ°èŠ‚ç‚¹) /Â `ocrcheck -config`Â (æŸ¥çœ‹é…ç½®ä½ç½®)ã€‚

- **`ocrdump`ï¼š**Â å°† OCR çš„å†…å®¹ä»¥å¯è¯»æ ¼å¼å¯¼å‡ºåˆ°æ–‡ä»¶ï¼ˆç”¨äºè¯Šæ–­ï¼ŒåŒ…å«æ•æ„Ÿä¿¡æ¯éœ€ä¿æŠ¤ï¼‰ã€‚

- **`cluvfy`Â (Cluster Verification Utility)ï¼š**Â **æå…¶é‡è¦**çš„å·¥å…·ï¼Œç”¨äºåœ¨é›†ç¾¤ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µï¼ˆå®‰è£…å‰ã€å®‰è£…ä¸­ã€å®‰è£…åã€èŠ‚ç‚¹æ·»åŠ å‰/åç­‰ï¼‰æ‰§è¡Œ**ç³»ç»Ÿä¸€è‡´æ€§æ£€æŸ¥å’ŒéªŒè¯**ã€‚ä¾‹å¦‚ï¼š
```bash
cluvfy stage -pre crsinst -n all -verbose     # GI å®‰è£…å‰çš„é¢„æ£€æŸ¥ã€‚
cluvfy stage -post crsinst -n all -verbose    # GI å®‰è£…åçš„æ£€æŸ¥ã€‚
cluvfy comp ha [-n all]       # æ£€æŸ¥é«˜å¯ç”¨æ€§ç»„ä»¶ï¼ˆCRS, CSS, ç½‘ç»œç­‰ï¼‰ã€‚
cluvfy comp nodecon -n all    # æ£€æŸ¥èŠ‚ç‚¹é—´è¿é€šæ€§ã€‚
cluvfy comp space -n all      # æ£€æŸ¥ç£ç›˜ç©ºé—´ã€‚
```


- **GI æ—¥å¿—æ–‡ä»¶ï¼š**Â è™½ç„¶ä¸æ˜¯å‘½ä»¤ï¼Œä½†é€šè¿‡å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚Â `adrci`Â æˆ–ç›´æ¥æŸ¥çœ‹ï¼‰è®¿é—®æ—¥å¿—æ˜¯ç»´æŠ¤çš„æ ¸å¿ƒã€‚å…³é”®æ—¥å¿—ä½äºÂ `$GRID_HOME/log/<hostname>`Â ä¸‹ï¼ŒåŒ…æ‹¬ï¼š
```bash

crsd/        # CRSD å®ˆæŠ¤è¿›ç¨‹æ—¥å¿— (`crsd.log`)ã€‚
cssd/        # CSSD å®ˆæŠ¤è¿›ç¨‹æ—¥å¿— (`ocssd.log`)ã€‚
ohasd/       # OHASD å®ˆæŠ¤è¿›ç¨‹æ—¥å¿— (`ohasd.log`)ã€‚
agent/       # èµ„æºä»£ç†æ—¥å¿—ã€‚
alert<hostname>.log   # é›†ç¾¤çš„è­¦æŠ¥æ—¥å¿—ï¼ˆç±»ä¼¼äºæ•°æ®åº“çš„ alert logï¼‰ã€‚
```


### å…³é”®ç»´æŠ¤è¦ç‚¹

1. **æƒé™ï¼š**
    
    - `crsctl`Â çš„å¾ˆå¤šæ“ä½œï¼ˆå°¤å…¶æ˜¯å¯åœé›†ç¾¤æ ˆã€ä¿®æ”¹é›†ç¾¤é…ç½®ï¼‰éœ€è¦Â `root`Â æˆ–Â `grid`Â ç”¨æˆ·ï¼ˆå±äºÂ `asmdba`,Â `asmadmin`,Â `asmoper`Â ç»„ï¼‰æƒé™ã€‚
        
    - `srvctl`,Â `asmcmd`,Â `ocrcheck`Â ç­‰é€šå¸¸ä½¿ç”¨Â `grid`Â ç”¨æˆ·ï¼ˆç®¡ç† ASM å’Œé›†ç¾¤èµ„æºï¼‰æˆ–Â `oracle`Â ç”¨æˆ·ï¼ˆç®¡ç†æ•°æ®åº“èµ„æºï¼‰ã€‚
        
2. **ç»„åˆä½¿ç”¨ï¼š**Â ç»´æŠ¤ä»»åŠ¡é€šå¸¸éœ€è¦ç»„åˆä½¿ç”¨è¿™äº›å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œåœæ­¢æ•°æ®åº“æœåŠ¡ (`srvctl stop service`)ï¼Œåœæ­¢æ•°æ®åº“å®ä¾‹ (`srvctl stop instance`)ï¼Œå¸è½½ç£ç›˜ç»„ (`srvctl stop diskgroup`)ï¼Œæœ€åå¯èƒ½åœæ­¢ ASM (`srvctl stop asm`) æˆ–é›†ç¾¤æ ˆ (`crsctl stop crs`) è¿›è¡Œç»´æŠ¤ã€‚
    
3. **`srvctl`Â vsÂ `crsctl`Â for Resourcesï¼š**Â å¯¹äºæ•°æ®åº“ã€å®ä¾‹ã€æœåŠ¡ã€ç›‘å¬å™¨ç­‰èµ„æºï¼Œ**ä¼˜å…ˆä½¿ç”¨Â `srvctl`**ã€‚`srvctl`Â æ›´æ™ºèƒ½ï¼Œèƒ½ç†è§£èµ„æºé—´çš„ä¾èµ–å…³ç³»å¹¶æ‰§è¡Œæ­£ç¡®çš„æ“ä½œåºåˆ—ï¼ˆå¦‚å¯åŠ¨ç›‘å¬å™¨åå†å¯åŠ¨æ•°æ®åº“å®ä¾‹ï¼‰ã€‚ç›´æ¥ä½¿ç”¨Â `crsctl start/stop resource`Â å¯èƒ½ç»•è¿‡è¿™äº›ä¾èµ–ï¼Œå¯¼è‡´é—®é¢˜ã€‚
    
4. **è°¨æ…æ“ä½œï¼š**Â å°¤å…¶æ˜¯Â `crsctl stop crs`,Â `crsctl replace votedisk`,Â `crsctl set css ...`Â ç­‰å‘½ä»¤ï¼Œæ“ä½œä¸å½“ä¼šå¯¼è‡´é›†ç¾¤ä¸å¯ç”¨ã€‚åŠ¡å¿…åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å¹¶ç†è§£å…¶å½±å“åå†åœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œã€‚
    
5. **æ–‡æ¡£å’Œå¸®åŠ©ï¼š**Â æ‰€æœ‰å‘½ä»¤éƒ½æ”¯æŒÂ `-h`Â æˆ–Â `help`Â å‚æ•°æŸ¥çœ‹å¸®åŠ©ï¼ˆä¾‹å¦‚Â `srvctl -h`,Â `crsctl -h`,Â `asmcmd help`ï¼‰ã€‚Oracle å®˜æ–¹æ–‡æ¡£æ˜¯ç»ˆæå‚è€ƒã€‚
    

**æ€»ç»“ï¼š**Â GI æä¾›çš„å‘½ä»¤é›† (`crsctl`,Â `srvctl`,Â `asmcmd`,Â `ocrcheck`,Â `cluvfy`) æ˜¯ç»´æŠ¤ Oracle RAC ç¯å¢ƒçš„ç‘å£«å†›åˆ€ğŸ”§ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›å‘½ä»¤å¯¹äºç¡®ä¿é›†ç¾¤çš„é«˜å¯ç”¨æ€§ã€æ€§èƒ½ç¨³å®šä»¥åŠè¿›è¡Œæ—¥å¸¸è¿ç»´å’Œæ•…éšœæ’é™¤è‡³å…³é‡è¦ã€‚å§‹ç»ˆä¼˜å…ˆä½¿ç”¨Â `srvctl`Â ç®¡ç†åº”ç”¨èµ„æºï¼Œä½¿ç”¨Â `crsctl`Â ç®¡ç†é›†ç¾¤æ¡†æ¶æœ¬èº«ï¼Œå¹¶åœ¨æ‰§è¡Œå…³é”®æ“ä½œå‰è¿›è¡Œå……åˆ†éªŒè¯ã€‚



### Oracle rac ä¸¤ä¸ªèŠ‚ç‚¹å…³æœºé‡å¯ æ“ä½œæ­¥éª¤

==å…³æœºå‰å‡†å¤‡==

1. **é€šçŸ¥ç›¸å…³äººå‘˜** ï¼š
	- æå‰é€šçŸ¥ä¸šåŠ¡éƒ¨é—¨åœæœºè®¡åˆ’
	- ç¡®è®¤æ‰€æœ‰åº”ç”¨è¿æ¥å·²æ–­å¼€
2. **å¤‡ä»½é‡è¦æ•°æ®** ï¼š
```sql
-- æ£€æŸ¥å½’æ¡£æ—¥å¿—çŠ¶æ€
SQL> ARCHIVE LOG LIST;
-- æ‰§è¡Œå…¨åº“å¤‡ä»½ï¼ˆæ ¹æ®å®é™…å¤‡ä»½ç­–ç•¥ï¼‰
RMAN> BACKUP DATABASE PLUS ARCHIVELOG;
```


==å®‰å…¨å…³é—­æ•°æ®åº“==

1. **åœæ­¢æ•°æ®åº“æœåŠ¡** ï¼š
```bash
# åœæ­¢æ•´ä¸ªæ•°æ®åº“
srvctl stop database -d <DB_NAME> -o immediate

# éªŒè¯æ•°æ®åº“çŠ¶æ€
srvctl status database -d <DB_NAME>
```

2. **åœæ­¢é›†ç¾¤æœåŠ¡** ï¼š
```bash
# åœæ­¢èŠ‚ç‚¹1æœåŠ¡
crsctl stop crs -f

# åœæ­¢èŠ‚ç‚¹2æœåŠ¡
ssh node2 "crsctl stop crs -f"

# éªŒè¯é›†ç¾¤çŠ¶æ€
crsctl check crs
```


==æ“ä½œç³»ç»Ÿå…³æœº==

```bash
# èŠ‚ç‚¹1å…³æœº
sudo shutdown -h now

# èŠ‚ç‚¹2å…³æœº
ssh node2 "sudo shutdown -h now"
```


==é‡å¯åå¯åŠ¨é›†ç¾¤==

1. **å¯åŠ¨é›†ç¾¤è½¯ä»¶** ï¼š
```bash
# èŠ‚ç‚¹1å¯åŠ¨
sudo crsctl start crs

# èŠ‚ç‚¹2å¯åŠ¨
ssh node2 "sudo crsctl start crs"
```

2. **éªŒè¯é›†ç¾¤çŠ¶æ€** ï¼š
```bash
# æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶æ€
crsctl check cluster -all

# æŸ¥çœ‹èµ„æºçŠ¶æ€
crsctl status res -t -init
```


==å¯åŠ¨æ•°æ®åº“æœåŠ¡==

1. **å¯åŠ¨æ•°æ®åº“** ï¼š
```bash
srvctl start database -d <DB_NAME>
```

2. **éªŒè¯æ•°æ®åº“çŠ¶æ€** ï¼š
```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
srvctl status database -d <DB_NAME>

# æ£€æŸ¥å®ä¾‹çŠ¶æ€
srvctl status instance -d <DB_NAME> -i <INSTANCE1>
srvctl status instance -d <DB_NAME> -i <INSTANCE2>
```



==å…¨é¢å¥åº·æ£€æŸ¥==

1. **æ•°æ®åº“è¿æ¥æµ‹è¯•** ï¼š
```sql
SQL> SELECT inst_id, status, database_status FROM gv$instance;
```

2. **é›†ç¾¤èµ„æºæ£€æŸ¥** ï¼š
```bash
# æ£€æŸ¥VIPçŠ¶æ€
crsctl status res ora.<DB_NAME>.vip -t

# æ£€æŸ¥ç›‘å¬çŠ¶æ€
lsnrctl status LISTENER_SCAN1
```

3. **ASMç£ç›˜ç»„æ£€æŸ¥** ï¼š
```sql
SQL> SELECT name, state, total_mb, free_mb FROM v$asm_diskgroup;
```

4. **æ—¥å¿—é”™è¯¯æ£€æŸ¥** ï¼š
```bash
# æ£€æŸ¥é›†ç¾¤æ—¥å¿—
alertlog_path=$ORACLE_BASE/diag/crs/$(hostname -s)/crs/trace/alert.log
grep -i error $alertlog_path | tail -50
```


==å…³é”®æ³¨æ„äº‹é¡¹==

1. **å…³æœºé¡ºåºåŸåˆ™** ï¼š
	- å…ˆåœæ•°æ®åº“ â†’ å†åœé›†ç¾¤æœåŠ¡ â†’ æœ€ååœOS
	- å¯åŠ¨æ—¶åå‘æ“ä½œ
2. **è¶…æ—¶å¤„ç†** ï¼š
```bash
# å¼ºåˆ¶åœæ­¢å¡ä½çš„èµ„æº
crsctl stop res ora.<resource>.db -f
```
3. **SCANç›‘å¬é—®é¢˜å¤„ç†** ï¼š
```bash
srvctl stop scan_listener
srvctl start scan_listener
```
4. **èŠ‚ç‚¹å¯åŠ¨ä¸åŒæ­¥å¤„ç†** ï¼š
```bash
# é‡æ–°åŒæ­¥èŠ‚ç‚¹é…ç½®
crsctl sync cluster -all
```


==ç»´æŠ¤çª—å£æ£€æŸ¥è¡¨==

| æ­¥éª¤ | æ“ä½œå†…å®¹ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | å®Œæˆæ—¶é—´ |
| ---|---|---|---|--- |
| 1 | æ•°æ®åº“åœæ­¢ | æ‰€æœ‰å®ä¾‹DOWN |  |  |
| 2 | CRSåœæ­¢ | æ‰€æœ‰èµ„æºOFFLINE |  |  |
| 3 | OSå…³æœº | èŠ‚ç‚¹ç”µæºå…³é—­ |  |  |
| 4 | CRSå¯åŠ¨ | æ‰€æœ‰èµ„æºONLINE |  |  |
| 5 | æ•°æ®åº“å¯åŠ¨ | æ‰€æœ‰å®ä¾‹OPEN |  |  |
| 6 | åº”ç”¨éªŒè¯ | ä¸šåŠ¡è¿æ¥æ­£å¸¸ |  |  |

> **é‡è¦æç¤º** ï¼šç”Ÿäº§ç¯å¢ƒæ“ä½œå‰åŠ¡å¿…åœ¨æµ‹è¯•ç¯å¢ƒæ¼”ç»ƒå®Œæ•´æµç¨‹ï¼Œå¹¶ç¡®ä¿æœ‰å®Œæ•´çš„å¤‡ä»½å’Œå›é€€æ–¹æ¡ˆã€‚å»ºè®®ä¿ç•™è‡³å°‘30åˆ†é’Ÿç¼“å†²æ—¶é—´å¤„ç†æ„å¤–æƒ…å†µã€‚
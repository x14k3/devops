# Zabbix 自动发现与自动注册

现在有这样一个需求，公司采购了100台主机，并且需要监控这100台主机，这个工作量有点大。如果真是一台一台的去弄的话，最近这一两天就什么都别做了，而且效率还低。我们可以把这100台连好网络，在部署系统的过程中让这些主机自动配置并启动好zabbix-agent服务。然后让zabbix server自动添加这100台主机，这样的话不仅提升效率，还能节省下大量时间，这个自动添加有两种方式：

自动发现（被动模式）：**zabbix Server 主动的去发现所有的客户端**，然后将客户端的信息登记在服务端的机器上

自动注册（主动模式）：z**abbix agent主动上报自己的信息**，发送给zabbix Server

# 自动发现

1.配置自动发现

![](assets/image-20221127214531283-20230610173809-0tcs27g.png)​

2.配置自动发现后的动作

![](assets/image-20221127214536354-20230610173809-xs4oeq5.png)​

![](assets/image-20221127214541534-20230610173809-qchhxhp.png)​

![](assets/image-20221127214546432-20230610173809-ienhv27.png)​

---

# 自动注册

1.修改agent配置文件

```python
######################## 主动模式（agent > server） ########################
ServerActive=192.168.10.145 # zabbix服务端的ip和端口。
StartAgents=0               # 关闭被动模式，开启主动模式，此时agent客户端不会监听10050端口
HostnameItem=system.hostname
# Autoregistration actions 
HostMetadata=linuxAuto

```

2.配置自动注册适用的模板

克隆被动模式的模板，都修改为主动式

![](assets/image-20221127214553274-20230610173809-xoo8mvm.png)​

![](assets/image-20221127214558548-20230610173809-c4qnyev.png)​

![](assets/image-20221127214604248-20230610173809-i2jw8xp.png)​

![](assets/image-20221127214609674-20230610173809-1zmpdn1.png)​

3.配置自动注册动作

![](assets/image-20221127214615439-20230610173809-nrpvv5o.png)​

![](assets/image-20221127214620438-20230610173809-o7qidx2.png)​

![](assets/image-20221127214625437-20230610173809-2unmb98.png)​

4.启动agent客户端

**注意：**  使用主动模式，配置->主机->可用性中的”ZBX”是不变绿的，这点要注意。

‍

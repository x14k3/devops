

[ELK-7.17.0 搭建](ELK-7.17.0%20搭建.md%20搭建/ELK-7.17.0%20搭建.md> "ELK-7.17.0 搭建")
[elk 8.0.0 部署](elk%208.0.0%20部署.md "ELK-8.0.0搭建")
[elk-cerebro](elk-cerebro.md "ELK-监控cerebro")
[ELK 优化/日常运维](ELK%20优化-日常运维.md%20优化-日常运维/ELK%20优化-日常运维.md> "ELK 优化/日常运维")

一般我们需要进行日志分析场景：直接在日志文件中 grep、awk 就可以获得自己想要的信息。但在规模较大的场景中，此方法效率低需要集中化的日志管理，所有服务器上的日志收集汇总。常见解决思路是建立集中式日志收集系统，将所有节点上的日志统一收集，管理，访问。 一般大型系统是一个分布式部署的架构，不同的服务模块部署在不同的服务器上，问题出现时，大部分情况需要根据问题暴露的关键信息，定位到具体的服务器和服务模块，构建一套集中式日志系统，可以提高定位问题的效率。

一个完整的集中式日志系统，需要包含以下几个主要特点：

- 收集－能够采集多种来源的日志数据
- 传输－能够稳定的把日志数据传输到中央系统
- 存储－如何存储日志数据
- 分析－可以支持 UI 分析
- 警告－能够提供错误报告，监控机制 ELK 提供了一整套解决方案，并且都是开源软件，之间互相配 合使用，完美衔接，高效的满足了很多场合的应用。目前主流的一种日志系统。

## ELK 简介

ELK 是三个开源软件的缩写，分别表示：Elasticsearch , Logstash, Kibana , 它们都是开源软件。新增了 一个 FileBeat，它是一个轻量级的日志收集处理工具(Agent)，

**Filebeat** 占用资源少，适合于在各个服务 器上搜集日志后传输给 Logstash，目前 **Filebeat** 包含四种工具：Packetbeat（搜集网络流量数据） Topbeat（搜集系统、进程和文件系统级别的 CPU 和内存使用情况等数据） Filebeat（搜集文件数据） Winlogbeat（搜集 Windows 事件日志数据）

**Logstash** 主要是用来日志的搜集、分析、过滤日志的工具，支持大量的数据获取方式。一般工作方式 为 c/s 架构，client 端安装在需要收集日志的主机上，server 端负责将收到的各节点日志进行过滤、修改等操作在一并发往 elasticsearch 上去。

**Elasticsearch** 是个开源分布式搜索引擎，提供搜集、分析、存储数据三大功能。它的特点有：分布式， 零配置，自动发现，索引自动分片，索引副本机制，restful 风格接口，多数据源，自动搜索负载等。

**Kibana** 也是一个开源和免费的工具，Kibana是一个与Elasticsearch协同工作的开源分析和可视化平台，Kibana 可以让你更方便地对 Elasticsearch 中数据进行操作，包括高级的数据分析以及在图表中可视化您的数据。

![](image-20221127213954507-20230610173808-um9qtkc.png)

### logstash与filebeat

因为logstash是jvm跑的，资源消耗比较大，所以后来作者又用golang写了一个功能较少但是资源消耗也小的轻量级的logstash-forwarder。
不过作者只是一个人，加入http\://elastic.co公司以后，因为es公司本身还收购了另一个开源项目packetbeat，而这个项目专门就是用golang的，有整个团队，所以es公司干脆把logstash-forwarder的开发工作也合并到同一个golang团队来搞，于是新的项目就叫filebeat了。

**工作流程如下：**

- 应用服务器运行过程中就会产生日志，filebeat负责把指定路径的日志收集起来提交到redis；
- redis会以key的形式存储日志；
- logstash会在redis里面input日志信息并做分析过滤，然后转发给es；
- es对日志分片和索引；
- kibana通过web形式将es里面的日志展示出来，Kibana 可以通过可视化界面对Elasticsearch 中数据进行操作。

# PostgreSQL流复制

PostgreSQL在9.X版本之后提供了基于Standby的异步流复制， 所谓流复制，就是从服务器通过tcp流从主服务器中同步相应的数据。与基于文件日志传送相比，流复制允许保持从服务器更新。 从服务器连接主服务器，其产生的流WAL记录到从服务器， 而不需要等待主服务器写完WAL文件。

PostgreSQL在数据目录下的pg_xlog子目录中维护了一个WAL日志文件，该文件用于记录数据库文件的每次改变，这种日志文件机制提供了一种数据库热备份的方案，PostgreSQL传送wal日志的方式有两种：基于文件的日志传送和流复制。

* WAL日志归档  
  写完一个WAL日志后，才把WAL日志文件拷贝到standby数据库中，这样通常备库会落后主库一个WAL日志文件。（日志级别）
* 流复制  
  只要master库一产生日志，就会马上传递到standby库，同第一种相比有更低的同步延迟，从实时性角度优先采用流复制方案。（事务级别）

‍

PostgreSQL物理流复制按照同步方式分为两类：

* 异步流复制
* 同步流复制

物理流复制具有以下特点：  
 1、延迟极低，不怕大事务  
 2、支持断点续传  
 3、支持多副本  
 4、配置简单  
 5、备库与主库物理完全一致，并支持只读

‍
